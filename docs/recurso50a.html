<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Métodos y Simulación Estadística" />


<title> Casos de estudio</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> </a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Métodos
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Software R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso10a.html">Introducción a R</a>
    </li>
    <li>
      <a href="recurso10b.html">Objetos en R</a>
    </li>
    <li>
      <a href="recurso10c.html">Función en R</a>
    </li>
    <li>
      <a href="recurso10d.html">Funciones `apply`, `lapply` y `sapply`</a>
    </li>
    <li>
      <a href="recurso10e.html">RMarkDown</a>
    </li>
    <li>
      <a href="recurso10f.html">Proyecto en RStudio</a>
    </li>
    <li>
      <a href="recurso10g.html">Librerías</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Análisis de datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso20a.html">Análisis de datos</a>
    </li>
    <li>
      <a href="recurso21a.html">Tablas de frecuencia</a>
    </li>
    <li>
      <a href="recurso22a.html">Indicadores de posición</a>
    </li>
    <li>
      <a href="recurso23a.html">Indicadores de centro</a>
    </li>
    <li>
      <a href="recurso24a.html">Indicadores de disperción</a>
    </li>
    <li>
      <a href="recurso25a.html">Indicadores de forma</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Gráficas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso30a.html">Gráficas</a>
    </li>
    <li>
      <a href="recurso31a.html">Cualitativas y cuantitativas discretas</a>
    </li>
    <li>
      <a href="recurso32a.html">Cuantitativas</a>
    </li>
    <li>
      <a href="recurso33a.html">Especiales</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Conceptos y procesamiento
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso40a.html">Algunos conceptos</a>
    </li>
    <li>
      <a href="recurso41a.html">Importar</a>
    </li>
    <li>
      <a href="recurso42a.html">Ordenar</a>
    </li>
    <li>
      <a href="recurso43a.html">Transformar</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Casos e informe
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso50a.html">Caso 1</a>
    </li>
    <li>
      <a href="recurso51a.html">Caso 2</a>
    </li>
    <li>
      <a href="recurso52a.html">Informe</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Referencias
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso60a.html">Referencias</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><span style="color:#686868"> <strong>Casos
de estudio</strong></span></h1>
<h4 class="author">Métodos y Simulación Estadística</h4>

</div>


</br></br>
<h2>
Caso 1
</h2>
<h3>
Introducción
</h3>
<p>En el contexto del desarrollo económico moderno, la productividad, la
eficiencia y la eficacia son objetivos clave en el ámbito laboral y
empresarial. No obstante, el equilibrio entre la vida personal y
profesional se ha convertido en un aspecto fundamental para el bienestar
de los empleados. La satisfacción laboral no solo depende del entorno de
trabajo, sino también de factores personales como el descanso, la salud
física y mental, y las responsabilidades fuera del ámbito laboral. <a
href="https://raw.githubusercontent.com/Centromagis/metodosySIM1-V2/main/docs/data/Encuesta%20empleados.xlsx">Descargar
Encuesta Empleados</a></p>
<div class="caja-nota">
<h3>
Observación:
</h3>
<blockquote>
<ul>
<li>Estos datos no tienen datos faltantes ni inconsistencas.</li>
</ul>
</blockquote>
</div>
<hr />
<h3>
Objetivos
</h3>
<p>A partir del análisis de la base de datos, se busca explorar las
experiencias de vida de los empleados a través de los siguientes
objetivos:</p>
<ul>
<li><p>Estudiar si el descanso, medido en tiempo de sueño por noche,
está sociado con la percepción de satisfacción en el entorno de
trabajo.</p></li>
<li><p>Determinar si un mayor nivel de ejercicio semanal está
relacionado con la duración del sueño.</p></li>
<li><p>Analizar si la percepción del estrés está relacionado con la
posición jerárquica dentro de una organización.</p></li>
</ul>
<hr />
</br></br>
<h3>
Descripción y clasificación de las variables
</h3>
<p>En la <strong>Tabla 1.15</strong> se describen y clasifican las
variables, de acuerdo a su naturaleza.</p>
</br>
<center>
<strong>Tabla 1.15</strong> Descripción y clasificación de las variables
seleccionadas.
</center>
<table>
<colgroup>
<col width="20%" />
<col width="64%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th>Nombre</th>
<th>Descripción</th>
<th>Clasificación</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Satisfacción laboral</strong></td>
<td>Nivel de satisfacción laboral en una escala del 1 al 5, donde 1 es
‘muy poco satisfecho’ y 5 es ‘muy satisfecho’.</td>
<td>Cualitativa ordinal</td>
</tr>
<tr class="even">
<td><strong>Tiempo de sueño</strong></td>
<td>Tiempo de sueño diario (horas), con un mínimo de 4 y un máximo de
10.</td>
<td>Cuantitativa continua</td>
</tr>
<tr class="odd">
<td><strong>Nivel de estrés</strong></td>
<td>Nivel de estrés en una escala del 1 al 5, donde 1 es ‘muy bajo’ y 5
es ‘muy alto’.</td>
<td>Cualitativa ordinal</td>
</tr>
<tr class="even">
<td><strong>Tiempo de actividad física</strong></td>
<td>Tiempo de actividad física semanal (horas), con un mínimo de 0 y un
máximo de 5.</td>
<td>Cuantitativa continua</td>
</tr>
<tr class="odd">
<td><strong>Cargo</strong></td>
<td>Categoría del cargo del empleado: gerente, intermedio, junior, líder
o pasante.</td>
<td>Cualitativa ordinal</td>
</tr>
</tbody>
</table>
<p>A partir de las <strong>Tablas 1.16</strong> y <strong>1.17</strong>
se pueden hacer las siguientes observaciones:</p>
<ul>
<li><p>Los empleados duermen entre 1 y 10 horas. El 50% duerme como
máximo 7 horas (mediana de 7 horas). La variabilidad del tiempo de sueño
respecto a la media es moderada (coeficiente de variación de 14.3%), con
un sesgo casi nulo (coeficiente de asimetría de 0.08) y una distribución
que no se aleja mucho de la normal (curtosis de -0.13).</p></li>
<li><p>Los empleados que practican algún tipo de actividad física lo
hacen por un máximo de 5 horas semanales. El 50% lo hace hasta 2 horas
(mediana de 2 horas), y la variabilidad con respecto a la media es alta
(coeficiente de variación de 47.6%). La distribución es aproximadamente
simétrica (coeficiente de asimetría de 0.02) y algo más plana que la
normal (curtosis de -0.43).</p></li>
<li><p>Se observa que la mayoría de los empleados reporta un nivel de
satisfacción laboral alto (4) con un 41.29%, un nivel de estrés bajo (1)
con un 59.80%, y ejercen el cargo de “Gerente” el 35.33%, que constituye
la moda en la muestra.</p></li>
</ul>
</br>
<center>
<strong>Tabla 1.16</strong> Estadísticas descriptivas de las variables
cuantitativas seleccionadas.
</center>
<table>
<colgroup>
<col width="17%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="4%" />
<col width="13%" />
<col width="15%" />
<col width="10%" />
<col width="10%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="center">Mínimo</th>
<th align="center">Máximo</th>
<th align="center">Mediana</th>
<th align="center">Media</th>
<th align="center">Desviación estándar</th>
<th align="center">Coef. de variación (%)</th>
<th align="center">Primer cuartil</th>
<th align="center">Tercer cuartil</th>
<th align="center">Asimetría</th>
<th align="center">Curtosis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Tiempo de sueño</strong></td>
<td align="center">1</td>
<td align="center">10</td>
<td align="center">7</td>
<td align="center">7.01</td>
<td align="center">1.00</td>
<td align="center">14.3</td>
<td align="center">6.3</td>
<td align="center">7.7</td>
<td align="center">0.08</td>
<td align="center">-0.13</td>
</tr>
<tr class="even">
<td align="left"><strong>Tiempo de actividad física</strong></td>
<td align="center">0</td>
<td align="center">5</td>
<td align="center">2</td>
<td align="center">2.03</td>
<td align="center">0.97</td>
<td align="center">47.6</td>
<td align="center">1.3</td>
<td align="center">2.7</td>
<td align="center">0.02</td>
<td align="center">-0.43</td>
</tr>
</tbody>
</table>
</br>
<center>
<strong>Tabla 1.17</strong> Estadística de las variables cualitativas
seleccionadas.
</center>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="center">Moda</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Satisfacción laboral</strong></td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left"><strong>Nivel de estrés</strong></td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="left"><strong>Cargo</strong></td>
<td align="center">Gerente</td>
</tr>
</tbody>
</table>
<hr />
<br/></br>
<h3>
Descripciones asociadas al objetivo 1
</h3>
<p>La información presentada en la <strong>Figura 1.48</strong>
corresponde a la <strong>Tabla 1.18</strong>. En la <strong>Figura
1.49</strong>, se superponen las curvas de densidad para facilitar la
comparación de la distribución del tiempo de sueño en los diferentes
niveles.</p>
<center>
<img src="img/hist_caso1.png" width="100%" style="display: block; margin: auto;" />
<strong>Figura 1.48</strong> Distribución del tiempo de sueño por
categorías de satisfacción laboral.
</center>
<p></br></p>
<center>
<strong>Tabla 1.18</strong> Densidades, frecuencias absoluta y relativa
por cada clase (intervalo) del tiempo de sueño (horas).
</center>
<pre>
Tabla para Satisfacción laboral = 1 
      Clase Frecuencia_Absoluta Frecuencia_Relativa    Densidad
1   4 - 4.5                   8         0.019184652 0.038369305
2   4.5 - 5                  13         0.031175060 0.062350120
3   5 - 5.5                  39         0.093525180 0.187050360
4   5.5 - 6                  60         0.143884892 0.287769784
5   6 - 6.5                  75         0.179856115 0.359712230
6   6.5 - 7                  90         0.215827338 0.431654676
7   7 - 7.5                  58         0.139088729 0.278177458
8   7.5 - 8                  45         0.107913669 0.215827338
9   8 - 8.5                  17         0.040767386 0.081534772
10  8.5 - 9                   8         0.019184652 0.038369305
11  9 - 9.5                   3         0.007194245 0.014388489
12 9.5 - 10                   1         0.002398082 0.004796163

Tabla para Satisfacción laboral = 2 
      Clase Frecuencia_Absoluta Frecuencia_Relativa    Densidad
1   4 - 4.5                   1         0.003610108 0.007220217
2   4.5 - 5                   5         0.018050542 0.036101083
3   5 - 5.5                  12         0.043321300 0.086642599
4   5.5 - 6                  23         0.083032491 0.166064982
5   6 - 6.5                  50         0.180505415 0.361010830
6   6.5 - 7                  62         0.223826715 0.447653430
7   7 - 7.5                  59         0.212996390 0.425992780
8   7.5 - 8                  29         0.104693141 0.209386282
9   8 - 8.5                  22         0.079422383 0.158844765
10  8.5 - 9                   5         0.018050542 0.036101083
11  9 - 9.5                   4         0.014440433 0.028880866
12 9.5 - 10                   5         0.018050542 0.036101083

Tabla para Satisfacción laboral = 3 
      Clase Frecuencia_Absoluta Frecuencia_Relativa    Densidad
1   4 - 4.5                   1         0.001766784 0.003533569
2   4.5 - 5                   9         0.015901060 0.031802120
3   5 - 5.5                  28         0.049469965 0.098939929
4   5.5 - 6                  61         0.107773852 0.215547703
5   6 - 6.5                 107         0.189045936 0.378091873
6   6.5 - 7                 135         0.238515901 0.477031802
7   7 - 7.5                  81         0.143109541 0.286219081
8   7.5 - 8                  78         0.137809187 0.275618375
9   8 - 8.5                  44         0.077738516 0.155477032
10  8.5 - 9                  18         0.031802120 0.063604240
11  9 - 9.5                   3         0.005300353 0.010600707
12 9.5 - 10                   1         0.001766784 0.003533569

Tabla para Satisfacción laboral = 4 
      Clase Frecuencia_Absoluta Frecuencia_Relativa    Densidad
1   4 - 4.5                   2         0.001601281 0.003202562
2   4.5 - 5                  19         0.015212170 0.030424339
3   5 - 5.5                  48         0.038430745 0.076861489
4   5.5 - 6                  79         0.063250600 0.126501201
5   6 - 6.5                 193         0.154523619 0.309047238
6   6.5 - 7                 254         0.203362690 0.406725380
7   7 - 7.5                 240         0.192153723 0.384307446
8   7.5 - 8                 205         0.164131305 0.328262610
9   8 - 8.5                 124         0.099279424 0.198558847
10  8.5 - 9                  53         0.042433947 0.084867894
11  9 - 9.5                  25         0.020016013 0.040032026
12 9.5 - 10                   7         0.005604484 0.011208967

Tabla para Satisfacción laboral = 5 
      Clase Frecuencia_Absoluta Frecuencia_Relativa    Densidad
1   4 - 4.5                   1         0.001937984 0.003875969
2   4.5 - 5                  11         0.021317829 0.042635659
3   5 - 5.5                  33         0.063953488 0.127906977
4   5.5 - 6                  41         0.079457364 0.158914729
5   6 - 6.5                  74         0.143410853 0.286821705
6   6.5 - 7                  59         0.114341085 0.228682171
7   7 - 7.5                 112         0.217054264 0.434108527
8   7.5 - 8                  62         0.120155039 0.240310078
9   8 - 8.5                  52         0.100775194 0.201550388
10  8.5 - 9                  44         0.085271318 0.170542636
11  9 - 9.5                  23         0.044573643 0.089147287
12 9.5 - 10                   4         0.007751938 0.015503876
</pre>
<center>
<img src="img/densidades1-caso1.png" width="100%" style="display: block; margin: auto;" />
<strong>Figura 1.49</strong> Distribución del tiempo de sueño por
categorías de satisfacción laboral.
</center>
<p></br></p>
<p>En la <strong>Figura 1.49</strong> se muestran los polígonos de
densidad que describen la distribución del tiempo de sueño para los
cinco niveles de satisfacción laboral. A partir de esta visualización y
de las tablas de frecuencia, se pueden destacar los siguientes
puntos:</p>
<ul>
<li><p>Se aprecia un desplazamiento progresivo hacia la derecha de las
curvas a medida que aumenta el nivel de satisfacción, lo que puede
sugerir que las personas más satisfechas tienden a dormir más.</p></li>
<li><p>Las distribuciones asociadas a los niveles 1 y 2 se encuentran
concentradas en torno a las 6–7 horas de sueño, con colas más largas
hacia los valores bajos. El nivel 1 muestra un pico de densidad más
estrecho y desplazado hacia la izquierda, concentrando a la mayoría de
los casos entre 5.5 y 7 horas. En el nivel 2, la distribución se vuelve
un poco más simétrica y se empieza a notar una mayor frecuencia de
personas que duermen entre 6.5 y 8 horas, aunque todavía persiste una
densidad significativa en valores inferiores.</p></li>
<li><p>En el nivel 3 se observa una distribución más equilibrada, con un
aumento en la densidad entre 6.5 y 8 horas. La curva es más ancha, lo
que sugiere mayor variabilidad en los hábitos de sueño para este grupo,
pero con una clara concentración en torno a las 6.5 horas.</p></li>
<li><p>A partir del nivel 4, las curvas de densidad muestran un
desplazamiento más claro hacia la derecha, con un aumento en la densidad
entre 6.5 y 8.5 horas. La curva correspondiente al nivel 5 es la más
extendida hacia valores altos y tiene su moda alrededor de las 7.5
horas.</p></li>
</ul>
<p>La <strong>Figura 1.50</strong> muestra curvas de densidad, sin
requerir la elaboración detallada de tablas de frecuencias. Estas curvas
pueden emplearse en lugar de los presentados en la <strong>Figura
1.49</strong>.</p>
<p>Al complementar la interpretación de las curvas de densidad con los
coeficientes de asimetría, curtosis y gráficos de cajas, se destacan los
siguientes aspectos:</p>
<ul>
<li><p>Los valores del coeficiente de asimetría (Skewness) varían entre
0.00 y 0.33, indicando que las distribuciones no están fuertemente
sesgadas. En los niveles 2 (0.33) y 3 (0.11) se observan colas
ligeramente más extendidas hacia la derecha (horas de sueño más
elevadas), mientras que en los niveles 1 (0.09) y 4 (0.01) la asimetría
es muy baja, lo cual sugiere distribuciones casi simétricas en torno a
su media (ver <strong>Tabla 1.19</strong>).</p></li>
<li><p>Los coeficientes de curtosis van de -0.59 a 0.60, lo que indica
formas mesocúrticas. El nivel 2 (curtosis = 0.60) presenta colas algo
más pesadas o un pico más marcado, mientras que el nivel 5 (curtosis =
-0.59) se inclina hacia una distribución algo más plana alrededor del
centro (ver <strong>Tabla 1.19</strong>).</p></li>
</ul>
<center>
<img src="img/densidades-caso1.png" width="100%" style="display: block; margin: auto;" />
<strong>Figura 1.50</strong> Distribución del tiempo de sueño por
categorías de satisfacción laboral.
</center>
<p></br></p>
<ul>
<li><p>Al analizar los cinco niveles de satisfacción laboral, se observa
que algunos empleados duermen solo 4.0 horas (mínimo). En los niveles 1
y 3, el tiempo de sueño puede llegar hasta 9.6 horas, mientras que en
los otros niveles existen empleados que alcanzan incluso las 10.0 horas
de descanso (ver <strong>Tabla 1.19</strong> y <strong>Figura
1.51</strong>).</p></li>
<li><p>En los primeros cuatro niveles de satisfacción laboral se
identifican personas con duraciones de sueño atípicas, ya sea
significativamente mayores o menores que el rango típico. En el nivel 1,
el 0.7 % de los participantes duerme más de lo habitual, registrando
entre 9.5 y 9.6 horas de sueño. En los niveles 2 y 4 también se detectan
grupos con valores de sueño inusuales (3.6 % en el nivel 2 y 0.4 % en el
nivel 4). Quienes duermen menos en el nivel 2 registran entre 4.0 y 4.7
horas, mientras que en el nivel 4 lo hacen entre 4.0 y 4.4 horas. Por su
parte, quienes duermen más en el nivel 2 alcanzan entre 9.2 y 10 horas,
y en el nivel 4 descansan entre 9.9 y 10 horas. En el nivel 5, por el
contrario, no se observan valores de sueño atípicos (ver <strong>Tabla
1.19</strong> y <strong>Figura 1.51</strong>).</p></li>
<li><p>Al analizar los cuartiles de los cinco niveles de satisfacción
laboral, se observa que, para los niveles 2, 3 y 4, al menos el 50% de
sus empleados duerme más horas que el 50% de los empleados con los
tiempos más bajos en el nivel 1. De hecho, la mediana de sueño en el
nivel 1 (6.6 horas) es la más baja de todos los niveles. De manera
similar, el 25% de los empleados con menos horas de sueño en el nivel 1
registra valores inferiores a, por lo menos, el 75% de los tiempos de
los otros cuatro niveles. Por otro lado, el 25% de los empleados con más
horas de sueño en el nivel 5 supera, al menos, el 75% de los tiempos
registrados en los demás niveles. En conjunto, estos datos indican que
los empleados del nivel 1 suelen dormir menos en comparación con los
otros niveles, mientras que los del nivel 5 tienden a registrar las
duraciones de sueño más altas (ver <strong>Tabla 1.19</strong> y
<strong>Figura 1.51</strong>).</p></li>
</ul>
<center>
<img src="img/cajas_caso1.png" width="100%" style="display: block; margin: auto;" />
<strong>Figura 1.51</strong> Distribución del tiempo de sueño por
categorías de satisfacción laboral.
</center>
<p></br></p>
<ul>
<li><p>En los niveles 2, 4 y 5, la mediana del tiempo de sueño es igual
o supera levemente las 7.0 horas, lo que indica que la mitad de los
empleados en estos niveles duermen aproximadamente 7.0 horas. Esto
sugiere un mayor tiempo de descanso en comparación con los niveles 1 y
3, cuyas medianas se sitúan en 6.6 y 6.8 horas, respectivamente (ver
<strong>Tabla 1.19</strong>).</p></li>
<li><p>Al analizar el rango de los tiempos de sueño en cada nivel de
satisfacción laboral, se observa que los niveles 1, 4 y 5 presentan
valores similares, alrededor de 6.0 horas, mientras que los niveles 2 y
3 registran rangos de aproximadamente 5.6 horas. En cuanto al
coeficiente de variación, los niveles 1 y 5 muestran variabilidad
moderada respecto a la media, con valores cercanos (15.1% y 15.8%,
respectivamente), mientras que en los niveles 2, 3 y 4 la variabilidad
en torno a la media es también moderada y aunque menor es muy parecida
(13.8%, 13.3% y 13.3%). Estos resultados indican una variabilidad
moderada de los tiempos de sueño con respecto a la media, con
diferencias mínimas entre los distintos niveles de satisfacción laboral
(ver <strong>Tabla 1.19</strong>).</p></li>
</ul>
<br/><br/>
<center>
<strong>Tabla 1.19</strong> Estadísticas para el tiempo de sueño
agrupadas por nivel de satisfacción laboral.
</center>
<table>
<colgroup>
<col width="10%" />
<col width="3%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="7%" />
<col width="7%" />
<col width="9%" />
<col width="9%" />
<col width="4%" />
<col width="7%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Satisfacción laboral</th>
<th align="center">Mínimo</th>
<th align="center">Máximo</th>
<th align="center">Mediana</th>
<th align="center">Media</th>
<th align="center">Primer cuartil</th>
<th align="center">Tercer cuartil</th>
<th align="center">Coef. de variación</th>
<th align="center">Coef. de asimetría</th>
<th align="center">Curtosis</th>
<th align="center">% de atípicos</th>
<th align="center">Intervalo de atípicos menores</th>
<th align="center">Intervalo de atípicos mayores</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="center">4.0</td>
<td align="center">9.6</td>
<td align="center">6.6</td>
<td align="center">6.60</td>
<td align="center">5.9</td>
<td align="center">7.3</td>
<td align="center">15.1</td>
<td align="center">0.09</td>
<td align="center">-0.03</td>
<td align="center">0.7</td>
<td align="center"></td>
<td align="center">[9.5, 9.6]</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="center">4.0</td>
<td align="center">10.0</td>
<td align="center">7.0</td>
<td align="center">6.98</td>
<td align="center">6.4</td>
<td align="center">7.5</td>
<td align="center">13.9</td>
<td align="center">0.33</td>
<td align="center">0.60</td>
<td align="center">3.6</td>
<td align="center">[4, 4.7]</td>
<td align="center">[9.2, 10]</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="center">4.1</td>
<td align="center">9.6</td>
<td align="center">6.8</td>
<td align="center">6.88</td>
<td align="center">6.2</td>
<td align="center">7.6</td>
<td align="center">13.3</td>
<td align="center">0.11</td>
<td align="center">-0.30</td>
<td align="center">0.2</td>
<td align="center">[4.1, 4.1]</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="center">4.0</td>
<td align="center">10.0</td>
<td align="center">7.1</td>
<td align="center">7.12</td>
<td align="center">6.5</td>
<td align="center">7.8</td>
<td align="center">13.3</td>
<td align="center">0.01</td>
<td align="center">-0.08</td>
<td align="center">0.4</td>
<td align="center">[4, 4.4]</td>
<td align="center">[9.9, 10]</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="center">4.0</td>
<td align="center">10.0</td>
<td align="center">7.2</td>
<td align="center">7.20</td>
<td align="center">6.3</td>
<td align="center">8.0</td>
<td align="center">15.8</td>
<td align="center">0.00</td>
<td align="center">-0.59</td>
<td align="center">0.0</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><br/><br/> En conjunto, estos hallazgos sugieren que, conforme sube
la satisfacción laboral, el porcentaje de empleados que duerman un
número de horas superior tiende a aumentar levemente. La distribución
del tiempo de sueño entre los niveles 2 y 3 de satisfacción son
parecidas, mientras que en el resto de niveles la diferencia es un poco
más pronunciada.</p>
<hr />
<br/></br>
<h3>
Descripciones asociadas al objetivo 2
</h3>
<center>
<img src="img/dispersion_caso1.png" width="100%" style="display: block; margin: auto;" />
<strong>Figura 1.52</strong> Relación entre actividad física y tiempo de
sueño.
</center>
<p></br></p>
<p>De la <strong>Figura 1.52</strong> se puede concluir:</p>
<ul>
<li><p>Los empleados realizan entre 0 y 5 horas de actividad física
semanal, y la mayoría se concentra entre 1 y 3 horas. La variabilidad
con respecto a la media es relativamente alta, pues se observan personas
que no practican ejercicio alguno y otras que alcanzan el máximo de 5
horas por semana. Esto coincide con las estadísticas descriptivas
anteriores, que muestran una media cercana a 2 horas y una variabilidad
relativa alta respecto a la media.</p></li>
<li><p>El tiempo de sueño de los empleados oscila entre 4 y 10 horas
diarias, con la mayor parte de los empleados durmiendo entre 6 y 8
horas, y un punto máximo alrededor de 7 horas. Esto coincide con las
estadísticas descriptivas anteriores, que muestran una media cercana a 7
horas y una dispersión relativa moderada respecto a la media.</p></li>
<li><p>A simple vista, no se aprecia una tendencia claramente creciente
o decreciente (ni lineal ni curvilínea) entre el tiempo de sueño y la
actividad física. Los puntos están dispersos en la zona central del
diagrama, lo que sugiere que no existe una asociación significativa
entre ambas variables.</p></li>
</ul>
<p>A simple vista, no se aprecia una tendencia claramente creciente o
decreciente (ni lineal ni curvilínea) entre el tiempo de sueño y la
actividad física. Los puntos están dispersos en la zona central del
diagrama, lo que sugiere que no existe una asociación significativa
entre ambas variables.</p>
<br/></br>
<h3>
Descripciones asociadas al objetivo 3
</h3>
<center>
<img src="img/barplot1_caso1.png" width="100%" style="display: block; margin: auto;" />
<strong>Figura 1.53</strong> Relación entre nivel de estrés y cargo del
empleado.
</center>
<p></br></p>
<center>
<img src="img/barplot2_caso1.png" width="100%" style="display: block; margin: auto;" />
<strong>Figura 1.54</strong> Relación entre nivel de estrés y cargo del
empleado.
</center>
<p></br></p>
<p>De la <strong>Figura 1.53</strong> y <strong>Figura 1.54</strong>
permiten comparar el nivel de estrés por cada uno de los cargos de los
empleados.</p>
<ul>
<li><p>En todos los cargos, el nivel de estrés 1 (el más bajo) concentra
el mayor porcentaje de empleados. Esta tendencia es particularmente
marcada en los cargos de Gerente (61.0%) y Junior (61.5%). El porcentaje
más bajo de este nivel se presenta en los Pasantes (53.5%), lo cual
sugiere que, aunque el estrés bajo es predominante, su prevalencia varía
ligeramente entre los cargos.</p></li>
<li><p>Los niveles 1 y 2, que representan niveles bajos de estrés,
agrupan más del 75% de los empleados en todas las categorías laborales.
Este patrón indica una percepción general de estrés controlado en la
organización. No obstante, los Pasantes destacan por tener el mayor
porcentaje en el nivel 2 (22.8%), lo cual puede reflejar una percepción
de mayor presión relativa en este grupo.</p></li>
<li><p>El nivel 3, correspondiente a un estrés moderado, alcanza su
valor más alto también en los Pasantes (17.3%). En contraste, Gerentes
(13.7%) y Líderes (15.5%) presentan proporciones más bajas en esta
categoría, lo que podría estar relacionado con una mayor experiencia en
el manejo de situaciones laborales demandantes.</p></li>
<li><p>En cuanto a los niveles más altos de estrés (niveles 4 y 5), las
proporciones son relativamente bajas en general. Los porcentajes más
cercanos a un 8% se ven en cargos Junior e Intermedios, mientras que los
Pasantes tienen los valores más bajos en los niveles 4 y 5 combinados
(solo 6.4%).</p></li>
</ul>
<p>Estos hallazgos indican que parece no parece existir variaciones en
la percepción del estrés según el cargo y la tendencia general es hacia
niveles bajos de estrés en toda la organización. Se concluye que la
posición jerárquica no parece influir de manera significativa en la
percepción del estrés, aunque los pasantes reportan una mayor carga
relativa en los niveles intermedios, mientras que gerentes y líderes
tienden a concentrarse más en los niveles bajos.</p>
<hr />
<br/><br/>
<h3>
Anexos
</h3>
<p>A continuación se presentan los códigos para reproducir las tablas y
gráficos que se presentan en los resultados.</p>
<p><br/><br/> Códigos que la generan la <strong>Tabla 1.15</strong>.</p>
<pre>
# Cargar las bibliotecas necesarias
library(readxl)      # Para leer archivos Excel
library(dplyr)       # Para la manipulación de datos
library(tidyr)       # Para la manipulación de datos
library(kableExtra)  # Para el formateo de tablas

# Leer el archivo de datos
data1 <- read_xlsx("data/Encuesta empleados.xlsx")

# Seleccionar las variables de interés
variables <- data1 %>%
  dplyr::select(JobSatisfaction, SleepHours, Stress, PhysicalActivityHours, JobLevel)

# Renombrar las columnas para mayor claridad
colnames(variables) <- c("Satisfacción laboral", "Tiempo de sueño", "Nivel de estrés",
                         "Tiempo de actividad física", "Cargo")

# Definir los nombres de las variables y sus descripciones
nombre_variables <- colnames(variables)
descripcion_variables <- c(
  "Nivel de satisfacción laboral en una escala del 1 al 5, donde 1 es 'muy poco satisfecho' y 5 es 'muy satisfecho'.", 
  "Tiempo de sueño diarias (horas), con un mínimo de 4 y un máximo de 10.", 
  "Nivel de estrés en una escala del 1 al 5, donde 1 es 'muy bajo' y 5 es 'muy alto'.",
  "Tiempo de actividad física semanal (horas), con un mínimo de 0 y un máximo de 5.", 
  "Categoría del cargo del empleado: gerente, intermedio, junior, líder o pasante."
)

# Clasificación de las variables
clasificacion_variables <- c("Cualitativa ordinal", "Cuantitativa continua", 
                             "Cualitativa ordinal", "Cuantitativa continua",
                             "Cualitativa ordinal")

# Crear un data frame con la información estructurada
tabla_variables <- data.frame(
  Nombre = nombre_variables,
  Descripción = descripcion_variables,
  Clasificación = clasificacion_variables
)

# Generar la tabla con formato mejorado
kable(tabla_variables, caption = "Tabla 1.11 Descripción y clasificación de las variables seleccionadas") %>%
kable_styling(bootstrap_options = c("striped"))  # Aplica un estilo con filas alternas
</pre>
<p><br/><br/> Códigos para generar la <strong>Tablas 1.16</strong>.</p>
<pre>
# Escribir en español
Sys.setlocale("LC_ALL", "es_ES.UTF-8")

# Cargar las bibliotecas necesarias
library(dplyr)
library(e1071)         # Para calcular asimetría y curtosis
library(knitr)         # Para generar tablas con kable
library(kableExtra)    # Para mejorar el formato de las tablas

# Seleccionar solo las variables de interés
datos_generales <- data1 %>%
  dplyr::select(SleepHours, PhysicalActivityHours)

# Crear función para calcular estadísticas
resumen_estadistico <- function(variable, nombre_variable) {
  tibble(
    Variable = nombre_variable,
    Minimo = min(variable, na.rm = TRUE),
    Maximo = max(variable, na.rm = TRUE),
    Mediana = median(variable, na.rm = TRUE),
    Media = round(mean(variable, na.rm = TRUE), 2),
    Desviacion_Estandar = round(sd(variable, na.rm = TRUE), 2),
    Coef_Variacion = round((sd(variable, na.rm = TRUE) / mean(variable, na.rm = TRUE)) * 100, 1),
    Cuartil_1 = quantile(variable, 0.25, na.rm = TRUE),
    Cuartil_3 = quantile(variable, 0.75, na.rm = TRUE),
    Asimetria = round(skewness(variable, na.rm = TRUE), 2),
    Curtosis = round(kurtosis(variable, na.rm = TRUE), 2)
  )
}

# Aplicar la función a cada variable
estadisticas_sueno <- resumen_estadistico(datos_generales$SleepHours, "Tiempo de Sueño")
estadisticas_actividad <- resumen_estadistico(datos_generales$PhysicalActivityHours, "Tiempo de Actividad Física")

# Unir ambas tablas
estadisticas_generales <- bind_rows(estadisticas_sueno, estadisticas_actividad)

# Crear tabla con kable
kable(estadisticas_generales, format = "html", caption = "Tabla 1.12 Estadísticas descriptivas generales") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive"), full_width = FALSE) %>%
  column_spec(1, bold = TRUE)
</pre>
<p><br/><br/> Códigos para generar la <strong>Tablas 1.17</strong>.</p>
<pre>
# Escribir en español
Sys.setlocale("LC_ALL", "es_ES.UTF-8")

# Cargar las bibliotecas necesarias
library(dplyr)
library(knitr)
library(kableExtra)

# Función para calcular la moda de una variable categórica
moda <- function(x) {
  tab <- table(x)  # Crear tabla de frecuencias
  max_freq <- max(tab)  # Encontrar la frecuencia máxima
  modas <- names(tab[tab == max_freq])  # Obtener las categorías con la frecuencia máxima
  return(paste(modas, collapse = ", "))  # Devolver la moda (o modas si hay empate)
}

# Calcular la moda para cada variable cualitativa
moda_satisfaccion <- moda(data1$JobSatisfaction)
moda_estres <- moda(data1$Stress)
moda_cargo <- moda(data1$JobLevel)

# Crear la tabla de resultados
tabla_moda <- data.frame(
  Variable = c("Satisfacción Laboral", "Nivel de Estrés", "Cargo"),
  Moda = c(moda_satisfaccion, moda_estres, moda_cargo)
)

# Generar la tabla con kable
kable(tabla_moda, format = "html", caption = "Tabla 1.13. Moda de las variables cualitativas") %>%
kable_styling(bootstrap_options = c("striped", "hover", "responsive"), full_width = FALSE) %>%
column_spec(1, bold = TRUE)  # Resalta la columna de la variable analizada
</pre>
<p><br/><br/> Códigos para reproducir los resultados de la <strong>Tabla
1.18</strong> y <strong>Figura 1.48</strong>..</p>
<pre>
# Cargar las librerías necesarias
library(ggplot2)
library(dplyr)

# Asegurarse de que la variable JobSatisfaction es un factor
data1$JobSatisfaction <- as.factor(data1$JobSatisfaction)

# Definir un vector de cortes (breaks)

h<-hist(data1$SleepHours)
breaks_seq <- h$breaks  


# Gráfico de histogramas con frecuencia relativa
plot_histogramas <- ggplot(data1, aes(x = SleepHours, fill = JobSatisfaction)) +
  geom_histogram(aes(y = after_stat(count/sum(count))),
                 breaks = breaks_seq,
                 color = "white", alpha = 0.8) +
  facet_wrap(~ JobSatisfaction, ncol = 2) +
  scale_fill_manual(values = c("#440154FF", "#39568CFF", "#1F968BFF",
                               "#73D055FF", "#B8DE29FF")) +
  labs(x = "Tiempo de sueño (horas/día)",
       y = "Frecuencia relativa",
       fill = "Satisfacción laboral",
       title = "Histogramas del tiempo de sueño por nivel de satisfacción laboral") +
  theme_minimal() +
  theme(legend.position = "top")

# Gráfico de histogramas con densidad
plot_hist_dens <- ggplot(data1, aes(x = SleepHours, fill = JobSatisfaction)) +
  geom_histogram(aes(y = after_stat(density)),
                 breaks = breaks_seq,
                 color = "white", alpha = 0.8) +
  facet_wrap(~ JobSatisfaction, ncol = 2) +
  scale_fill_manual(values = c("#440154FF", "#39568CFF", "#1F968BFF",
                               "#73D055FF", "#B8DE29FF")) +
  labs(x = "Tiempo de sueño (horas/día)",
       y = "Densidad",
       fill = "Satisfacción laboral",
       title = "Histogramas de densidad del tiempo de sueño por nivel de satisfacción laboral") +
  theme_minimal() +
  theme(legend.position = "top")

# Para visualizar los gráficos, descomenta:
print(plot_histogramas)
print(plot_hist_dens)


# Generar tablas por cada nivel de JobSatisfaction utilizando los mismos breaks
niveles <- levels(data1$JobSatisfaction)
tabla_list <- list()

for (nivel in niveles) {
  # Filtrar datos por nivel
  subset_data <- data1 %>% filter(JobSatisfaction == nivel)
  
  # Calcular el histograma sin graficar utilizando los breaks comunes
  hist_nivel <- hist(subset_data$SleepHours, breaks = breaks_seq, plot = FALSE)
  
  # Crear la tabla con clases, frecuencia absoluta, relativa y densidad
  tabla_nivel <- data.frame(
    Clase = paste(head(hist_nivel$breaks, -1), hist_nivel$breaks[-1], sep = " - "),
    Frecuencia_Absoluta = hist_nivel$counts,
    Frecuencia_Relativa = hist_nivel$counts / sum(hist_nivel$counts),
    Densidad = hist_nivel$density
  )
  
  # Guardar la tabla en la lista
  tabla_list[[nivel]] <- tabla_nivel
}

# Imprimir las tablas para cada nivel de JobSatisfaction
for (nivel in niveles) {
cat("Tabla para Satisfacción laboral =", nivel, "\n")
print(tabla_list[[nivel]])
cat("\n")
}
</pre>
<p><br/><br/> Códigos para crear los polígonos de densidad de la
<strong>Figura 1.48</strong> y <strong>Figura 1.49</strong>.</p>
<pre>
# Cargar las librerías necesarias
library(ggplot2)
library(dplyr)

# Asegurarse de que la variable JobSatisfaction es un factor
data1$JobSatisfaction <- as.factor(data1$JobSatisfaction)

# Definir los cortes (breaks) 
h<-hist(data1$SleepHours)
breaks_seq <- h$breaks 

bin_width <- diff(breaks_seq)[1]  # Debe ser 0.2

# Calcular las densidades para cada nivel usando histogramas con cortes fijos
# Se arma un data frame con: JobSatisfaction, el punto central del bin y la densidad
density_data <- lapply(levels(data1$JobSatisfaction), function(lvl) {
  # Filtrar datos para el nivel actual
  subset_data <- data1 %>% filter(JobSatisfaction == lvl)
  
  # Calcular histograma sin graficar con los cortes fijos
  hist_obj <- hist(subset_data$SleepHours, breaks = breaks_seq, plot = FALSE)
  
  # Los puntos centrales (midpoints) de cada bin
  midpoints <- hist_obj$mids
  
  # Calcular la densidad para cada bin:
  # Frecuencia relativa = counts / total, y densidad = frecuencia relativa / ancho del bin
  dens_vals <- (hist_obj$counts / sum(hist_obj$counts)) / bin_width
  
  # Crear un data frame para este nivel
  data.frame(
    JobSatisfaction = lvl,
    x = midpoints,
    density = dens_vals
  )
})
density_data <- do.call(rbind, density_data)

# Para graficar polígonos, es conveniente "cerrar" cada curva:
# agregamos los puntos de inicio y fin, fijando y=0 en los extremos (x=mínimo y x=máximo de los cortes)
polygon_data <- density_data %>%
  group_by(JobSatisfaction) %>%
  arrange(x) %>%
  do({
    df <- .
    data.frame(
      JobSatisfaction = df$JobSatisfaction[1],
      # Agregamos el primer punto en x = mínimo (4) con density = 0,
      # luego los puntos originales y, finalmente, el último punto en x = máximo (10) con density = 0.
      x = c(min(breaks_seq), df$x, max(breaks_seq)),
      density = c(0, df$density, 0)
    )
  }) %>%
  ungroup()

# Ahora, se genera el gráfico con polígonos superpuestos para cada nivel, usando los colores indicados.
plot_overlay <- ggplot(polygon_data, aes(x = x, y = density, fill = JobSatisfaction, group = JobSatisfaction)) +
  geom_polygon(alpha = 0.5, color = "black") +
  scale_fill_manual(values = c("#440154FF", "#39568CFF", "#1F968BFF", "#73D055FF", "#B8DE29FF", "yellow2")) +
  labs(
    x = "Tiempo de sueño (horas/día)",
    y = "Densidad",
    title = "Polígonos de densidad del tiempo de sueño por nivel de satisfacción laboral",
    fill = "Satisfacción laboral"
  ) +
  theme_minimal() +
  theme(legend.position = "top")

# Mostrar el gráfico
print(plot_overlay)


# Gráfico de densidad del tiempo de sueño por categorías de satisfacción laboral
plot_densidades<-ggplot(data1, aes(x = SleepHours, fill = factor(JobSatisfaction))) +
  geom_density(alpha = 0.5) +  # Transparencia para facilitar la visualización de superposiciones
  scale_fill_manual(values = c("#440154FF", "#39568CFF", "#1F968BFF", "#73D055FF", "#B8DE29FF", "yellow2")) +
  labs(
    x = "Tiempo de sueño (horas/día)",
    y = "Densidad",
    fill = "Satisfacción laboral",
    title = ""  # Agregado título
  ) +
  theme_minimal() +
  theme(legend.position = "top")  # Mover la leyenda arriba para mejor visualización

print(plot_densidades)
</pre>
<p><br/><br/> Códigos para reproducir la <strong>Figura
1.50</strong>.</p>
<pre>
# Para usar español
Sys.setlocale("LC_ALL", "es_ES.UTF-8")  
 
# Cargar la biblioteca necesaria
library(ggplot2)

# Crear el boxplot mejorado
boxplot_caso1<-ggplot(data1, aes(x = factor(JobSatisfaction), y = SleepHours, fill = factor(JobSatisfaction))) +
  geom_boxplot(outlier.shape = 16, outlier.size = 2, alpha = 0.7) +  # Boxplot con atenuación de color
  scale_fill_manual(values = c("#440154FF", "#39568CFF", "#1F968BFF", "#73D055FF", "#B8DE29FF")) +  
  labs(x = "Satisfacción laboral", 
       y = "Tiempo de sueño (horas/día)", 
       title = "Distribución del tiempo de sueño por nivel de satisfacción laboral") +
  theme_minimal() +  # Estilo limpio y profesional
  theme(legend.position = "none",  # Quitar la leyenda, ya que el eje X ya muestra los niveles
        plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 13))
print(boxplot_caso1)
</pre>
<p><br/><br/> Códigos para crear la <strong>Tabla 1.19</strong>.</p>
<pre>
library(dplyr)
library(e1071)
library(knitr)
library(kableExtra)

# Calcular IQR y límites por grupo
data_enriquecida <- data1 %>%
  group_by(JobSatisfaction) %>%
  mutate(
    Q1 = quantile(SleepHours, 0.25, na.rm = TRUE),
    Q3 = quantile(SleepHours, 0.75, na.rm = TRUE),
    IQR = Q3 - Q1,
    L_inf = Q1 - 1.5 * IQR,
    L_sup = Q3 + 1.5 * IQR,
    Atipico = ifelse(SleepHours < L_inf | SleepHours > L_sup, TRUE, FALSE)
  )

# Resumen por grupo
tabla_datosobj1 <- data_enriquecida %>%
  group_by(JobSatisfaction) %>%
  summarise(
    Mínimo = min(SleepHours, na.rm = TRUE),
    Máximo = max(SleepHours, na.rm = TRUE),
    Mediana = median(SleepHours, na.rm = TRUE),
    Media = round(mean(SleepHours, na.rm = TRUE), 2),
    `Primer Cuartil` = unique(Q1),
    `Tercer Cuartil` = unique(Q3),
    `Coef. de Variación` = round((sd(SleepHours, na.rm = TRUE) / mean(SleepHours, na.rm = TRUE)) * 100, 1),
    `Coef. de Asimetría` = round(skewness(SleepHours, na.rm = TRUE), 2),
    Curtosis = round(kurtosis(SleepHours, na.rm = TRUE), 2),
    `% de Atípicos` = round(mean(Atipico, na.rm = TRUE) * 100, 1),
    `Intervalo de Atípicos Menores` = ifelse(
      sum(SleepHours < unique(L_inf), na.rm = TRUE) == 0, 
      "", 
      paste0("[", paste(range(SleepHours[SleepHours < unique(L_inf)], na.rm = TRUE), collapse = ", "), "]")
    ),
    `Intervalo de Atípicos Mayores` = ifelse(
      sum(SleepHours > unique(L_sup), na.rm = TRUE) == 0, 
      "", 
      paste0("[", paste(range(SleepHours[SleepHours > unique(L_sup)], na.rm = TRUE), collapse = ", "), "]")
    )
  )

# Mostrar tabla con formato
kable(tabla_datosobj1,
      col.names = c("Satisfacción Laboral", "Mínimo", "Máximo", "Mediana", "Media", 
                    "Primer Cuartil", "Tercer Cuartil", "Coef. de Variación", 
                    "Coef. de Asimetría", "Curtosis", "% de Atípicos", 
                    "Intervalo de Atípicos Menores", "Intervalo de Atípicos Mayores"),
      caption = "Tabla 1.14 Estadísticas para el tiempo de sueño agrupadas por nivel de satisfacción laboral") %>%
  kable_styling(bootstrap_options = c("striped")) %>%
  add_header_above(c(" " = 1, "Tiempo de Sueño" = 12))

</pre>
<p><br/><br/> Códigos para reproducir la <strong>Figura
1.52</strong>.</p>
<pre>
# Cargar las bibliotecas necesarias
library(ggplot2)  # Para la creación de gráficos
library(ggExtra)  # Para agregar distribuciones marginales

# Crear el scatter plot (gráfico de dispersión)
scatter_plot <- ggplot(data1, aes(x = PhysicalActivityHours, y = SleepHours)) +
  geom_point(size = 3, color = "#39568CFF", alpha = 0.7) +  # Puntos con transparencia para mejor visibilidad
  labs(
    x = "Tiempo de actividad física (horas/semana)", 
    y = "Tiempo de sueño (horas/día)", 
    title = "Relación entre actividad física y tiempo de sueño"
  ) +
  theme_classic() +  # Estilo limpio sin cuadrículas de fondo
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar título y mejorar apariencia
    axis.text = element_text(size = 12), 
    axis.title = element_text(size = 13)
  )

# Agregar densidades marginales en los ejes X e Y
scatter_with_density <- ggMarginal(
  scatter_plot,
  type = "density",  # Tipo de gráfico marginal (distribución de densidad)
  margins = "both",  # Mostrar densidades en ambos ejes
  fill = "skyblue",  # Color de las distribuciones
  alpha = 0.5        # Transparencia para evitar opacidad excesiva
)

# Mostrar el gráfico
scatter_with_density
</pre>
<p><br/><br/> Códigos para generar la <strong>Figura 1.53</strong>.</p>
<pre>
# Usar español
Sys.setlocale("LC_ALL", "es_ES.UTF-8")

# Cargar las bibliotecas necesarias
library(ggplot2)
library(dplyr)
library(tidyr)

# Crear tabla cruzada de frecuencia entre Nivel de Estrés y Cargo del Empleado
tabla_cruzada <- as.data.frame(table(Stress = data1$Stress, Cargo = data1$JobLevel))

# Renombrar las columnas para evitar errores de nombres
colnames(tabla_cruzada) <- c("Nivel de estrés", "Cargo", "Frecuencia")

# Convertir las variables en factores para un mejor control en ggplot2 y calcular el porcentaje por Cargo
tabla_cruzada <- tabla_cruzada %>%
  mutate(`Nivel de Estrés` = factor(`Nivel de estrés`, levels = unique(`Nivel de estrés`)),
         Cargo = factor(Cargo, levels = unique(Cargo))) %>%
  group_by(Cargo) %>%
  mutate(Porcentaje = Frecuencia / sum(Frecuencia) * 100) %>%
  ungroup()

# Crear gráfico de barras agrupadas usando porcentajes en el eje Y
barplot1 <- ggplot(tabla_cruzada, aes(x = Cargo, y = Porcentaje, fill = `Nivel de estrés`)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +  # Barras agrupadas
  scale_fill_manual(values = c("#440154FF", "#39568CFF", "#1F968BFF", "#73D055FF", "yellow2")) +  # Paleta de colores
  labs(
    x = "Cargo del empleado", 
    y = "Porcentaje", 
    title = "Distribución del nivel de estrés por cargo"
  ) +
  theme_minimal() +  # Estilo limpio sin fondo
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar título
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 13),
    legend.title = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 11)
  ) +
  guides(fill = guide_legend(title = "Nivel de estrés")) +
  scale_y_continuous(labels = function(x) paste0(x, "%"))  # Mostrar el porcentaje en el eje Y

# Mostrar el gráfico
print(barplot1)
</pre>
<p><br/><br/> Códigos para reproducir la <strong>Figura
1.54</strong>.</p>
<pre>
# Usar español
Sys.setlocale("LC_ALL", "es_ES.UTF-8")

# Cargar las bibliotecas necesarias
library(ggplot2)  # Para visualización
library(dplyr)    # Para manipulación de datos
library(scales)   # Para formateo de porcentajes

# Crear tabla cruzada asegurando que solo tenga tres columnas
tabla_cruzada <- as.data.frame(table(Stress = data1$Stress, Cargo = data1$JobLevel))


# Si hay una columna vacía, eliminarla
tabla_cruzada <- tabla_cruzada[, colnames(tabla_cruzada) != ""]

# Renombrar columnas asegurando que todas tengan nombres válidos
colnames(tabla_cruzada) <- c("Nivel_Estres", "Cargo", "Frecuencia")



# Convertir a tibble para evitar problemas con `group_by()`
tabla_cruzada <- as_tibble(tabla_cruzada)

# Calcular el porcentaje dentro de cada categoría de "Cargo"
tabla_cruzada <- tabla_cruzada %>%
  group_by(Cargo) %>%
  mutate(Porcentaje = Frecuencia / sum(Frecuencia))
  
  print(tabla_cruzada, n = Inf)

# Definir una paleta de colores personalizada para cada nivel de estrés
colores_estres <- c("1" = "#440154FF", "2" = "#39568CFF", "3" = "#1F968BFF", 
                    "4" = "#73D055FF", "5" = "#B8DE29FF")

# Crear el gráfico de barras apiladas normalizadas
barplot2<-ggplot(tabla_cruzada, aes(x = Cargo, y = Porcentaje, fill = Nivel_Estres)) + 
  geom_bar(stat = "identity", position = "fill") +  # Barras apiladas normalizadas
  scale_fill_manual(values = colores_estres) +  # Aplicar paleta de colores
  geom_text(aes(label = scales::percent(Porcentaje, accuracy = 0.1)), 
            position = position_stack(vjust = 0.5),  # Posicionar etiquetas en el centro
            color = "white", size = 3.0) +  # Texto en color blanco para visibilidad
  labs(
    title = "Distribución del nivel de estrés por cargo",
    x = "Cargo del empleado", 
    y = "Porcentaje", 
    fill = "Nivel de estrés"
  ) +
  scale_y_continuous(labels = scales::percent) +  # Formato del eje Y en porcentaje
  theme_minimal() +  # Estilo visual limpio
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar título
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 13),
    legend.title = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 11)
  )

print(barplot2)
</pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
